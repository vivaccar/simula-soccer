<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimulaSoccer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>
	<h1 style="text-align: center;">SimulaSoccer</h1>
	<br>
	<div style="overflow: hidden;">
		<div style="width: 50%; float: left; margin-left: 5%;">
			<table class="table-responsive">
				<thead>
					<th>#</th>
					<th>Time</th>
					<th>Pontos</th>
					<th>Jogos</th>
					<th>Vitorias</th>
					<th>Empates</th>
					<th>Derrotas</th>
					<th>Gols</th>
					<th>Gols sofridos</th>
					<th>Saldo de Gols</th>
					<th>Aproveitamento</th>
				</thead>
				<tbody>
					{% for team in teams_list %}
					<tr>
						<td>{{ forloop.counter }}</td>
						<td><img src="{{ team.logo }}" alt="" width="10%" height="10%"> {{ team.name }}</td>
						<td>{{ team.points }}</td>
						<td>{{ team.games_played }}</td>
						<td>{{ team.wins }}</td>
						<td>{{ team.draws }}</td>
						<td>{{ team.loss }}</td>
						<td>{{ team.goals_pro }}</td>
						<td>{{ team.goals_con }}</td>
						<td>{{ team.sg }}</td>
						<td>{{ team.aproveitamento }}%</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<div align="center" style="display: inline-block;">
			<table class="table-responsive">
				<form method="post" action="{% url 'prev_round' %}">
					{% csrf_token %}
					<input type="hidden" name="current_round" value="{{ current_round }}">
					<button type="submit" {% if current_round == 1 %}disabled{% endif %}>Rodada Anterior</button>
				</form>
				<h4>RODADA {{current_round}}</h4>
				<form method="post" action="{% url 'next_round' %}">
					{% csrf_token %}
					<input type="hidden" name="current_round" value="{{ current_round }}">
					<button type="submit" {% if current_round == 38 %}disabled{% endif %}>Proxima Rodada</button>
				</form>
				{% for game in games_list %}
				<form id="form_{{ game.id }}" method="post" action="{% url 'game' %}">
				{% csrf_token %}
				<div style="border: 1px solid gray;">
					<p style="font-size: 12px;">{{ game.timestamp }}</p>
					<input type="hidden" name="home_team" value="{{ game.home_team.name }}">
					<input type="hidden" name="away_team" value="{{ game.away_team.name }}">
					<input type="hidden" name="game_id" value="{{ game.id }}">
					<img src="{{ game.home_team.logo }}" alt=""  height="5%" width="5%"> {{ game.home_team.name }}
					<input type="number" {% if game.real_played == True %}disabled{% endif %} name="home_goals" id="home_goals_{{ game.id }}" min="0" max="9" value="{{ game.home_goals }}">	
					X
					<input type="number"  {% if game.real_played == True %}disabled{% endif %} name="away_goals" id="away_goals_{{ game.id }}" min="0" max="9" value="{{ game.away_goals }}">
					{{ game.away_team.name }} <img src="{{ game.away_team.logo }}" alt="" height="5%" width="5%">
					<p style="font-size: 12px;">{{ game.home_team.stadium }}</p>
				<div\>
			</form>
		</div>
		<script>
				document.addEventListener('DOMContentLoaded', function() {
					var homeGoalsInput = document.getElementById('home_goals_{{ game.id }}');
					var awayGoalsInput = document.getElementById('away_goals_{{ game.id }}');
					var form = document.getElementById('form_{{ game.id }}');

					homeGoalsInput.addEventListener('input', function() {
						checkInputs();
					});

					awayGoalsInput.addEventListener('input', function() {
						checkInputs();
					});

					function checkInputs() {
						if (homeGoalsInput.value !== '' && awayGoalsInput.value !== '') {
							form.submit();
						}
					}
				});
			</script>
			{% endfor %}
			</table>
			<br>
			<form method="post" action="{% url 'restart' %}">
			{% csrf_token %}
			<input type="submit" value="Restart">
			</form>
			<form method="post" action="{% url 'api' %}">
				{% csrf_token %}
				<input type="submit" value="API">
			</form>
	</div>
</body>
</html>
