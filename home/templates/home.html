<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimulaSoccer</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<style>
    .table-responsive {
        overflow-x: auto;
    }

/*     @media (max-width: 768px) {
        .right-column {
            margin-top: 20px;
        }
    }
    
    .left-column {
        margin-right: 10px;
    }*/

    .right-column {
        margin-left: 10%;
    }
</style>
<body>
	<nav class="navbar navbar-inverse" style="background-color: green;">
		<div class="container-fluid">
			<div class="navbar-header">
				<a href="{% url 'home' %}"><h2>SimulaSoccer</h2></a>
			  </div>
		</div>
	</nav>
	<br>
	<h2 style="text-align: center;">{{ league.league_name }}</h2>
	<br>
	<div class="container-fluid">
		<div class="row" style="width: 100%;">
			<div class="col-lg-6 left-column">
				<div class="table-responsive">
					<table class="table-striped">
						<thead>
							<th>Posicao</th>
							<th>Equipe</th>
							<th>Pontos</th>
							<th>Jogos</th>
							<th>Vitorias</th>
							<th>Empates</th>
							<th>Derrotas</th>
							<th>Gols</th>
							<th>Gols sofridos</th>
							<th>Saldo de gols</th>
							<th>Aproveitamento</th>
						</thead>
						<tbody>
							{% for team in teams_list %}
							<tr>
								<td class="text-center mb-4">{{ forloop.counter }}</td>
								<td><img src="{{ team.logo }}" alt="" width="15%" height="15%"> {{ team.name }}</td>
								<td class="text-center mb-4">{{ team.points }}</td>
								<td class="text-center mb-4">{{ team.games_played }}</td>
								<td class="text-center mb-4">{{ team.wins }}</td>
								<td class="text-center mb-4">{{ team.draws }}</td>
								<td class="text-center mb-4">{{ team.loss }}</td>
								<td class="text-center mb-4">{{ team.goals_pro }}</td>
								<td class="text-center mb-4">{{ team.goals_con }}</td>
								<td class="text-center mb-4">{{ team.sg }}</td>
								<td class="text-center mb-4">{{ team.aproveitamento }}%</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
			<div class="right-column">
	            <div class="d-flex justify-content-between align-items-center mt-4">
					<form class="d-inline" method="post" action="{% url 'prev_round' %}">
						{% csrf_token %}
						<input type="hidden" name="current_round" value="{{ current_round }}">
						<input type="hidden" name="league_id" value="{{ league.league_id }}">
						<button type="submit" class="btn btn-outline-success btn-sm" {% if current_round == 1 %}disabled{% endif %}>
							<i class="fas fa-chevron-left"></i> Anterior
						</button>
					</form>
					<h4 style="font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">RODADA {{current_round}}</h4>
					<form class="d-inline" method="post" action="{% url 'next_round' %}">
						{% csrf_token %}
						<input type="hidden" name="current_round" value="{{ current_round }}">
						<input type="hidden" name="league_id" value="{{ league.league_id }}">
						<button type="submit" class="btn btn-outline-success btn-sm" {% if current_round == 38 %}disabled{% endif %}>
							Pr√≥xima <i class="fas fa-chevron-right"></i>
						</button>
					</form>
				</div>
				<br>
				<ul class="list-group">
					{% for game in games_list %}
					<form id="form_{{ game.id }}" method="post" action="{% url league.url %}">
					{% csrf_token %}
					<div style="border-bottom: 1px solid rgb(84, 82, 117);">
						<input type="hidden" name="home_team" value="{{ game.home_team.name }}">
						<input type="hidden" name="away_team" value="{{ game.away_team.name }}">
						<input type="hidden" name="game_id" value="{{ game.id }}">
						<img src="{{ game.home_team.logo }}" alt=""  height="4%" width="4%"> {{ game.home_team.name }}
						<input type="number" {% if game.real_played == True %}disabled{% endif %} name="home_goals" id="home_goals_{{ game.id }}" min="0" max="9" value="{{ game.home_goals }}">	
						X
						<input type="number"  {% if game.real_played == True %}disabled{% endif %} name="away_goals" id="away_goals_{{ game.id }}" min="0" max="9" value="{{ game.away_goals }}">
						{{ game.away_team.name }} <img src="{{ game.away_team.logo }}" alt="" height="4%" width="4%">
						<p style="font-size: 12px;">{{ game.home_team.stadium }} - {{ game.local_time }}</p>
					</div>
					</form>
					<script>
						document.addEventListener('DOMContentLoaded', function() {
							var homeGoalsInput = document.getElementById('home_goals_{{ game.id }}');
							var awayGoalsInput = document.getElementById('away_goals_{{ game.id }}');
							var form = document.getElementById('form_{{ game.id }}');
			
							homeGoalsInput.addEventListener('input', function() {
								checkInputs();
							});
			
							awayGoalsInput.addEventListener('input', function() {
								checkInputs();
							});
			
							function checkInputs() {
								if (homeGoalsInput.value !== '' && awayGoalsInput.value !== '') {
									form.submit();
								}
							}
						});
					</script>
					{% endfor %}
				</ul>
			</div>
		</div>
	</div>
	<br>
</body>
<div align="center">
	<form method="post" action="{% url 'restart' %}">
	{% csrf_token %}
	<input type="hidden" name="league_id" value="{{ league.league_id }}">
	<button type="submit" class="btn btn-outline-success btn-sm">
		Restart <i class="fas fa-chevron-right"></i>
	</button>
	</form>
</div>	
<form method="post" action="{% url 'api' %}">
{% csrf_token %}
<input type="submit" value="API">
</form>
</html>

